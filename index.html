<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Игра с кубиком</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Добро пожаловать в Казино!</h1>
        </header>
        <main>
            <div class="game">
                <div class="dice-container">
                    <div id="dice" class="dice">
                        <div class="face front">1</div>
                        <div class="face back">2</div>
                        <div class="face right">3</div>
                        <div class="face left">4</div>
                        <div class="face top">5</div>
                        <div class="face bottom">6</div>
                    </div>
                </div>
                <div class="controls">
                    <button id="rollDiceButton">Кинуть кубик</button>
                </div>
            </div>
            <div class="balance">
                <p id="balanceText">Проверка баланса...</p>
                <div id="output"></div>
            </div>
            <div class="result">
                <p id="resultText"></p>
            </div>
        </main>
        <footer>
            <p>© 2024 Казино Онлайн</p>
        </footer>
    </div>

    <script src="script.js"></script>
    <script>
        window.addEventListener('load', function() {
            if (window.ethereum == undefined) {
                console.log('Please install MetaMask!');
                alert('Please install MetaMask!');
            } else {
                ethereum
                    .request({
                        method: 'net_version'
                    })
                    .then((result) => {
                        console.log("Сеть: " + result);
                    })
                    .catch((error) => {
                        console.log(error);
                    });

                ethereum
                    .request({
                        method: 'eth_accounts'
                    })
                    .then((accounts) => {
                        if (accounts.length > 0) {
                            getBalance(accounts[0]);
                        } else {
                            document.getElementById('balanceText').textContent = 'Не удалось получить баланс. Пожалуйста, разрешите доступ к вашему кошельку MetaMask.';
                        }
                    })
                    .catch((error) => {
                        console.log(error);
                        document.getElementById('balanceText').textContent = 'Не удалось получить баланс. Пожалуйста, разрешите доступ к вашему кошельку MetaMask.';
                    });
            }
        });

        function getBalance(address) {
            ethereum
                .request({
                    method: 'eth_getBalance',
                    params: [address]
                })
                .then((result) => {
                    console.log("Баланс: " + parseInt(result, 16) / 1e18);
                    document.getElementById("output").innerHTML =
                        "Баланс: " + parseInt(result, 16) / 1e18 + " ETH";
                    document.getElementById('balanceText').textContent = "Ваш баланс: " + parseInt(result, 16) / 1e18 + " ETH";
                })
                .catch((error) => {
                    console.log(error);
                    document.getElementById("output").innerHTML = error.message;
                    document.getElementById('balanceText').textContent = 'Не удалось получить баланс. Пожалуйста, разрешите доступ к вашему кошельку MetaMask.';
                });
        }

        document.getElementById('rollDiceButton').addEventListener('click', function() {
            const dice = document.getElementById('dice');
            const faces = 6;
            const roll = Math.floor(Math.random() * faces) + 1;

            // Удаляем все классы граней
            dice.className = 'dice';

            // Добавляем соответствующий класс для выпавшего числа
            dice.classList.add(`show-${roll}`);

            // Показываем выпавшее число
            setTimeout(() => {
                document.getElementById('resultText').textContent = `У вас выпало: ${roll}`;
            }, 1000);
        });
    </script>
</body>
</html>
